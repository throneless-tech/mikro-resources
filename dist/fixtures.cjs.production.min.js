"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("class-fixtures-factory"),r=require("@mikro-orm/core"),n=function(n){function a(e){var r=n.call(this)||this;return r.orm=e,r.defaultStore=new t.DefaultMetadataStore(!0),r}return e.__extends(a,n),a.prototype.make=function(e){var t,n=r.Utils.className(e.name),a=this.defaultStore.make(e);try{t=this.orm.getMetadata().get(n)}catch(e){return this.store[n]=a}var i={name:n,properties:Object.values(t.properties).map((function(e){var t=a.properties.find((function(t){return t.name===e.name}));return e.primary||"method"===e.type?null:{name:e.name,type:e.type,array:["1:m","m:n"].includes(e.reference),enum:e.enum,ignore:null==t?void 0:t.ignore,input:null==t?void 0:t.input,items:e.items||(null==t?void 0:t.items),max:(null==t?void 0:t.max)||3,min:(null==t?void 0:t.min)||1,scalar:"scalar"===e.reference||(null==t?void 0:t.scalar)}})).filter(Boolean)};return this.store[n]=i},a}(t.BaseMetadataStore),a=function(){function r(e,r){this.orm=e,this.factory=new t.FixtureFactory(r);var a=new n(e);this.factory.setMetadataStore(a),this.registerAllEntities(),this.factory.setAssigner(this.assigner.bind(this))}return r.prototype.register=function(e){this.factory.register(e)},r.prototype.registerAllEntities=function(){var t,r,n=this.orm.getMetadata(),a=Object.keys(n.getAll()).filter((function(e){return e[0]===e[0].toUpperCase()}));try{for(var i=e.__values(a),o=i.next();!o.done;o=i.next()){var s=n.get(o.value).class;this.register([s])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},r.prototype.assigner=function(t,r,n){var a;Array.isArray(n)&&r[t.name].add?(a=r[t.name]).add.apply(a,e.__spread(n)):r[t.name]=n},r.prototype.make=function(t){var r=this,n=this.factory.make(t);return{ignore:n.ignore,with:n.with,many:n.many,one:n.one,oneAndPersist:function(){return e.__awaiter(r,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return t=n.one(),[4,this.orm.em.persistAndFlush(t)];case 1:return e.sent(),[2,t]}}))}))},manyAndPersist:function(t){return e.__awaiter(r,void 0,void 0,(function(){var r;return e.__generator(this,(function(e){switch(e.label){case 0:return r=n.many(t),[4,this.orm.em.persistAndFlush(r)];case 1:return e.sent(),[2,r]}}))}))}}},r}();exports.FixtureFactory=a,exports.MetadataStore=n;
//# sourceMappingURL=fixtures.cjs.production.min.js.map
